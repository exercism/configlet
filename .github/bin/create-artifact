#!/usr/bin/env sh

artifacts_dir='artifacts'
mkdir -p "${artifacts_dir}"

binary_name='configlet'
build_tag="${GITHUB_REF_NAME}"

case "${OS}" in
  windows)
    artifact_file="${artifacts_dir}/${binary_name}_${build_tag}_${OS}_${ARCH}.zip"
    7z a "${artifact_file}" "${binary_name}.exe"
    ;;
  linux | macos)
    artifact_file="${artifacts_dir}/${binary_name}_${build_tag}_${OS}_${ARCH}.tar.gz"
    tar -cvzf "${artifact_file}" "${binary_name}"
    ;;
esac

echo "ARTIFACT_FILE=${artifact_file}" >> "${GITHUB_ENV}"
